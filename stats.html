<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
    <title>æ’è¡Œæ¦œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="cat1.png">
    <link rel="apple-touch-icon" href="cat1.png">    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ€„</text></svg>">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Zen Maru Gothic"', 'sans-serif'] },
                    colors: { 
                        cute: { 
                            red: '#ff6b6b',       // ç³–æœç´…
                            dark: '#c92a2a',      // æ·±ç´…å­—
                            yellow: '#ffd43b',    // äº®å¥¶é»ƒ
                            cream: '#fff0f3',     // ç²‰ç™½åº•
                            bg: '#ff8787',        // èƒŒæ™¯ç´…
                            green: '#51cf66'      // å‹è€…ç¶ 
                        } 
                    }
                }
            }
        }
    </script>
    <style>
        /* ä¿®æ”¹ 2: å…¨å±€å­—é«”æ”¾å¤§è¨­å®š (å„ªåŒ–ç‰ˆ) */
        :root {
            font-size: 17px; /* é›»è…¦ç‰ˆ */
        }
        @media (max-width: 768px) {
            :root {
                /* æ‰‹æ©Ÿç‰ˆåŸºæº–å­—é«”åŠ å¤§ï¼Œä½†ä¸è¦å¤§åˆ° 19px ä»¥å…ç ´ç‰ˆï¼Œæ”¹ 18px æ¯”è¼ƒå‰›å¥½ */
                font-size: 18px; 
            }
            /* å¼·åˆ¶è¦†è“‹ Tailwind çš„å°å­—é«”è¨­å®š */
            .text-\[10px\] { font-size: 12px !important; }
            .text-\[9px\] { font-size: 11px !important; }
            .text-\[8px\] { font-size: 10px !important; }
            .text-xs { font-size: 0.85rem !important; } 
            .text-sm { font-size: 1rem !important; } /* è®“å…§æ–‡æ›´æ¸…æ¥š */
            
            /* è®“æ—¥æ›†æ—¥æœŸå¤§ä¸€é»ï¼Œä½†ä¸è¦æ“ å£“ */
            .calendar-day { font-size: 0.95rem !important; }
        }

        body { 
            background-color: #ff8787; 
            background-image: radial-gradient(#ffffff 20%, transparent 20%), radial-gradient(#ffffff 20%, transparent 20%);
            background-color: #ff8787;
            background-position: 0 0, 10px 10px;
            background-size: 20px 20px;
            background-image: radial-gradient(rgba(255,255,255,0.2) 2px, transparent 2px), radial-gradient(rgba(255,255,255,0.2) 2px, transparent 2px);
            color: #495057;
            -webkit-tap-highlight-color: transparent;
            
            /* â˜… é—œéµä¿®æ­£ï¼šç¢ºä¿ä¸æœƒå‡ºç¾å·¦å³æ²è»¸ */
            overflow-x: hidden; 
            width: 100%;
            -webkit-font-smoothing: antialiased;
        }
        .card { 
            background: #ffffff; 
            border-radius: 2rem; 
            border: 4px solid #fff; 
            box-shadow: 0 6px 0 rgba(0,0,0,0.05), 0 10px 15px -3px rgba(0,0,0,0.1);
        }
        .tab-btn { transition: all 0.2s; border-bottom: 4px solid transparent; }
        .tab-btn.active { background-color: #ff6b6b; color: white; transform: translateY(-2px); border-bottom-color: #c92a2a; box-shadow: 0 4px 10px rgba(255, 107, 107, 0.4); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        
        .modal-enter { animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        /* æ–°å¢å‹•ç•«æ•ˆæœ */
        @keyframes float { 
            0%, 100% { transform: translateY(0) rotate(0deg); } 
            50% { transform: translateY(-20px) rotate(5deg); } 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        
        /* èƒŒæ™¯æ¼‚æµ®å…ƒç´  */
        .bg-floating-icon { 
            position: fixed; 
            z-index: 0; 
            opacity: 0.15; 
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
            pointer-events: none; 
            animation: float 8s ease-in-out infinite; 
            filter: grayscale(0.5);
        }

        /* æ—¥æ›†æ¨£å¼ */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day { 
            aspect-ratio: 1; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: center; 
            border-radius: 0.75rem; 
            font-size: 0.8rem; 
            font-weight: 900;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .calendar-day:hover { background-color: #fff0f3; transform: scale(1.05); z-index: 10; }
        .calendar-day.has-game { 
            background-color: #fff9db; 
            color: #e67700; 
            border-color: #ffd43b;
        }
        .calendar-day.selected { 
            background-color: #ff6b6b !important; 
            color: white !important; 
            box-shadow: 0 4px 0 #c92a2a;
            transform: translateY(-2px);
            border-color: transparent;
            z-index: 20;
        }
        .calendar-day.empty { pointer-events: none; background: transparent; }
    </style>
</head>
<body class="pb-24 pt-4 px-4 min-h-screen">

    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
        <div class="bg-floating-icon text-6xl" style="top: 10%; left: -5%; animation-delay: 0s;">ğŸ€„</div>
        <div class="bg-floating-icon text-5xl" style="top: 60%; right: -5%; animation-delay: 2s; animation-duration: 10s;">ğŸ²</div>
        <div class="bg-floating-icon text-4xl" style="bottom: 10%; left: 20%; animation-delay: 4s; font-size: 3rem;">ğŸ§§</div>
        <div class="bg-floating-icon text-7xl" style="top: 30%; right: 20%; animation-delay: 1s; animation-duration: 12s;">ğŸ€…</div>
        <div class="bg-floating-icon text-4xl" style="top: 5%; right: 30%; animation-delay: 3s;">â˜ï¸</div>
    </div>

    <div id="loading-overlay" class="fixed inset-0 z-[60] bg-cute-bg/95 backdrop-blur-md flex flex-col items-center justify-center hidden">
        <div class="flex gap-3 mb-6">
            <div class="w-16 h-20 bg-white rounded-2xl border-b-4 border-gray-200 shadow-xl flex items-center justify-center text-4xl animate-bounce" style="animation-delay: 0s;">ğŸ±</div>
            <div class="w-16 h-20 bg-white rounded-2xl border-b-4 border-gray-200 shadow-xl flex items-center justify-center text-4xl animate-bounce" style="animation-delay: 0.1s;">ğŸ€„</div>
            <div class="w-16 h-20 bg-white rounded-2xl border-b-4 border-gray-200 shadow-xl flex items-center justify-center text-4xl animate-bounce" style="animation-delay: 0.2s;">ğŸ§§</div>
        </div>
        <h3 class="text-3xl font-black text-white tracking-widest drop-shadow-md">è³‡æ–™åŒæ­¥ä¸­</h3>
    </div>

    <div class="flex justify-between items-center mb-6 text-white relative z-10">
        <div>
            <h1 class="text-3xl font-black drop-shadow-md flex items-center gap-2">
                <i class="fa-solid fa-calendar-check text-cute-yellow"></i> æ’è¡Œæ¦œ
            </h1>
            <p class="text-xs font-bold opacity-80 mt-1 pl-1" id="last-update">è³‡æ–™è®€å–ä¸­...</p>
        </div>
        <a href="index.html" class="bg-white/20 backdrop-blur-md border-2 border-white/50 px-4 py-2 rounded-2xl text-sm font-black hover:bg-white/30 transition shadow-sm hover:scale-105 active:scale-95">
            <i class="fa-solid fa-house mr-1"></i> å›å¤§å»³
        </a>
    </div>

    <div class="max-w-lg mx-auto relative z-20">
        
        <div class="bg-white/20 p-1.5 rounded-2xl flex mb-6 shadow-inner backdrop-blur-sm border-2 border-white/30">
        <button onclick="switchTab('overview')" id="btn-overview" class="tab-btn active flex-1 py-2.5 rounded-xl text-sm font-black transition whitespace-nowrap px-1 drop-shadow-sm">æˆ°æ³æ—¥æ›†</button>
        
        <button onclick="switchTab('ranking')" id="btn-ranking" class="tab-btn flex-1 py-2.5 rounded-xl text-sm font-black text-white hover:bg-white/10 transition whitespace-nowrap px-1 drop-shadow-md">é¢¨é›²æ¦œ</button>
        
        <button onclick="switchTab('achievement')" id="btn-achievement" class="tab-btn flex-1 py-2.5 rounded-xl text-sm font-black text-white hover:bg-white/10 transition whitespace-nowrap px-1 drop-shadow-md">æˆå°±</button>
        
        <button onclick="switchTab('guestbook')" id="btn-guestbook" class="tab-btn flex-1 py-2.5 rounded-xl text-sm font-black text-white hover:bg-white/10 transition whitespace-nowrap px-1 drop-shadow-md">ç•™è¨€</button>
    </div>

        <div id="tab-overview" class="space-y-4 animate-fade-in">
            
            <div id="fortune-card" class="card p-4 bg-gradient-to-r from-cute-red to-orange-400 text-white relative overflow-hidden border-none shadow-lg transform transition hover:scale-[1.02]">
                <div class="absolute -right-6 -top-6 text-7xl opacity-20 rotate-12 animate-pulse">âœ¨</div>
                <div class="relative z-10">
                    <h3 class="font-black text-xs mb-2 opacity-90 flex items-center gap-1"><i class="fa-solid fa-star text-yellow-300"></i> ä»Šæ—¥é›€é‹</h3>
                    <div class="flex items-center gap-4">
                        <div class="text-4xl bg-white/20 w-14 h-14 rounded-2xl flex items-center justify-center backdrop-blur-sm shadow-inner" id="fortune-icon">ğŸ²</div>
                        <div>
                            <div class="font-black text-2xl tracking-wide drop-shadow-sm" id="fortune-text">è¼‰å…¥ä¸­...</div>
                            <div class="text-xs font-bold opacity-90 mt-1" id="fortune-desc">...</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="card p-4 flex flex-col items-center justify-center relative overflow-hidden hover:scale-[1.02] transition">
                    <div class="absolute -right-4 -bottom-4 text-7xl text-gray-50 rotate-12 pointer-events-none z-0">ğŸ€„</div>
                    <span class="relative z-10 text-gray-400 text-[10px] font-black uppercase tracking-wider bg-gray-100 px-2 py-0.5 rounded-lg mb-1">ç¸½æˆ°å±€æ•¸</span>
                    <span class="relative z-10 text-3xl font-black text-cute-red" id="stat-total-games">0</span>
                </div>
                <div onclick="openFundModal()" class="card p-4 flex flex-col items-center justify-center relative overflow-hidden cursor-pointer hover:border-cute-yellow transition group border-2 border-transparent hover:scale-[1.02]">
                    <div class="absolute -right-4 -bottom-4 text-7xl text-yellow-50 rotate-12 pointer-events-none z-0">ğŸ’°</div>
                    <span class="relative z-10 text-gray-400 text-[10px] font-black uppercase tracking-wider bg-yellow-50 px-2 py-0.5 rounded-lg mb-1 flex items-center gap-1">å…¬åŸºé‡‘ <i class="fa-solid fa-pen text-[10px]"></i></span>
                    <span class="relative z-10 text-3xl font-black text-cute-yellow" id="stat-total-fund">0</span>
                    <div id="fund-base-display" class="relative z-10 text-[9px] font-bold text-gray-400 mt-1 bg-gray-100 px-2 py-0.5 rounded-full whitespace-nowrap max-w-full overflow-hidden text-ellipsis">...</div>
                </div>
            </div>

            <div class="card p-5 hover:shadow-lg transition duration-300">
                <div class="flex justify-between items-center mb-4">
                    <button onclick="changeMonth(-1)" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-cute-red hover:text-white transition flex items-center justify-center font-bold active:scale-90">
                        <i class="fa-solid fa-chevron-left"></i>
                    </button>
                    <h3 class="font-black text-lg text-cute-dark" id="calendar-title">2023å¹´ 10æœˆ</h3>
                    <button onclick="changeMonth(1)" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-cute-red hover:text-white transition flex items-center justify-center font-bold active:scale-90">
                        <i class="fa-solid fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-7 gap-1 mb-2 text-center">
                    <div class="text-xs font-black text-cute-red">æ—¥</div>
                    <div class="text-xs font-black text-gray-400">ä¸€</div>
                    <div class="text-xs font-black text-gray-400">äºŒ</div>
                    <div class="text-xs font-black text-gray-400">ä¸‰</div>
                    <div class="text-xs font-black text-gray-400">å››</div>
                    <div class="text-xs font-black text-gray-400">äº”</div>
                    <div class="text-xs font-black text-cute-red">å…­</div>
                </div>

                <div id="calendar-body" class="calendar-grid mb-4">
                    </div>

                <div id="day-detail-panel" class="bg-cute-cream rounded-xl p-4 border-2 border-dashed border-cute-red/30 hidden animate-fade-in">
                    <div class="flex justify-between items-start mb-2 border-b border-black/5 pb-2">
                        <h4 class="font-black text-cute-dark flex items-center gap-2">
                            <span id="detail-date" class="text-sm">10/24 (äº”)</span>
                            <span class="bg-cute-red text-white text-[10px] px-1.5 rounded-md shadow-sm">æœ¬æ—¥æœ‰å±€</span>
                        </h4>
                        <span id="detail-total" class="font-black text-sm text-gray-500">å…± 4 å±€</span>
                    </div>
                    
                    <div class="flex items-center gap-2 mb-2">
                         <span class="text-xs font-bold text-gray-400 bg-white px-2 py-0.5 rounded-full border border-gray-100">ğŸ† å¤§è´å®¶</span>
                         <span id="detail-winner" class="text-sm font-black text-cute-dark">è¼‰å…¥ä¸­...</span>
                    </div>

                    <div id="detail-hands" class="flex flex-wrap gap-1 mt-2 mb-3">
                        </div>

                    <div id="detail-rounds-list" class="space-y-2 mt-2 border-t border-dashed border-red-200 pt-2">
                        </div>
                </div>
                
                <div id="day-empty-panel" class="bg-gray-50 rounded-xl p-6 text-center border-2 border-dashed border-gray-200">
                    <div class="text-3xl grayscale opacity-30 mb-2">ğŸ€„</div>
                    <p class="text-xs font-bold text-gray-400">é€™å¤©é¢¨å¹³æµªéœï¼Œæ²’æœ‰æˆ°æ³</p>
                </div>
            </div>
        </div>

        <div id="tab-ranking" class="space-y-4 hidden">
            <div class="grid grid-cols-2 gap-3 animate-fade-in">
                <div class="card p-3 flex flex-col items-center text-center bg-yellow-50 border-cute-yellow transform hover:scale-105 transition">
                    <div class="text-3xl mb-1 animate-bounce" style="animation-duration: 2s;">ğŸ‘‘</div>
                    <div class="text-[10px] font-black text-yellow-600 bg-yellow-100 px-2 py-0.5 rounded-full mb-1">å¤§ç‰Œç‹</div>
                    <div class="font-black text-cute-dark text-sm w-full px-1 break-words whitespace-normal leading-tight min-h-[1.5rem] flex items-center justify-center" id="king-big">...</div>
                    <div class="text-[10px] text-gray-400 font-bold" id="king-big-val">0æ¬¡</div>
                </div>
            
                <div class="card p-3 flex flex-col items-center text-center bg-purple-50 border-purple-200 transform hover:scale-105 transition">
                    <div class="text-3xl mb-1 animate-pulse">ğŸ”¥</div>
                    <div class="text-[10px] font-black text-purple-600 bg-purple-100 px-2 py-0.5 rounded-full mb-1">é€£èŠç‹</div>
                    <div class="font-black text-cute-dark text-sm w-full px-1 break-words whitespace-normal leading-tight min-h-[1.5rem] flex items-center justify-center" id="king-continuance">...</div>
                    <div class="text-[10px] text-gray-400 font-bold" id="king-continuance-val">0é€£èŠ</div>
                </div>
            
                <div class="card p-3 flex flex-col items-center text-center bg-red-50 border-cute-red transform hover:scale-105 transition">
                    <div class="text-3xl mb-1 hover:rotate-12 transition">ğŸ¤¡</div>
                    <div class="text-[10px] font-black text-red-500 bg-red-100 px-2 py-0.5 rounded-full mb-1">è©èƒ¡ç‹</div>
                    <div class="font-black text-cute-dark text-sm w-full px-1 break-words whitespace-normal leading-tight min-h-[1.5rem] flex items-center justify-center" id="king-foul">...</div>
                    <div class="text-[10px] text-gray-400 font-bold" id="king-foul-val">0æ¬¡</div>
                </div>
            
                <div class="card p-3 flex flex-col items-center text-center bg-orange-50 border-orange-200 transform hover:scale-105 transition">
                    <div class="text-3xl mb-1 hover:-rotate-12 transition">ğŸ™€</div>
                    <div class="text-[10px] font-black text-orange-500 bg-orange-100 px-2 py-0.5 rounded-full mb-1">ç›¸å…¬ç‹</div>
                    <div class="font-black text-cute-dark text-sm w-full px-1 break-words whitespace-normal leading-tight min-h-[1.5rem] flex items-center justify-center" id="king-penalty">...</div>
                    <div class="text-[10px] text-gray-400 font-bold" id="king-penalty-val">0æ¬¡</div>
                </div>
            </div>

            <div class="card p-5 animate-fade-in" style="animation-delay: 0.1s;">
                <h3 class="font-black text-cute-dark mb-4 flex justify-between items-end">
                    <span class="flex items-center gap-2"><span class="bg-cute-yellow w-6 h-6 rounded-full text-white flex items-center justify-center text-xs shadow-sm">ğŸ†</span> é›€ç¥æ’è¡Œæ¦œ</span>
                    <span class="text-[10px] text-gray-400 bg-gray-100 px-2 py-1 rounded-full">ä¾ç¸½åˆ†æ’åº</span>
                </h3>
                <div id="rank-list" class="space-y-2">
                    <div class="text-center text-gray-400 py-6 text-xs">æ­£åœ¨æ´—ç‰Œ...</div>
                </div>
            </div>
        </div>

        <div id="tab-achievement" class="space-y-3 hidden">
            <div id="achievement-list" class="grid grid-cols-1 gap-3"></div>
        </div>

        <div id="tab-guestbook" class="hidden space-y-4">
            <div class="card p-5 border-t-8 border-cute-red animate-fade-in">
                <h3 class="text-sm font-black text-cute-dark mb-3 uppercase tracking-wider flex items-center gap-2">
                    <i class="fa-solid fa-pen-nib text-cute-red"></i> ç™¼å¸ƒæ–°ç•™è¨€
                </h3>
                <div class="space-y-3">
                <div class="flex flex-col gap-3">
                    <input type="date" id="msg-date" class="w-full h-11 bg-cute-cream border-0 rounded-2xl px-3 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-red transition appearance-none uppercase">
                    
                <div class="flex gap-2 h-11 items-stretch">
                    <input type="text" id="msg-name" placeholder="ä½ æ˜¯èª°ï¼Ÿ(å¯æ‰‹å¡«)" class="flex-1 min-w-0 h-full bg-cute-cream border-0 rounded-2xl px-3 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-red transition">
                    
                    <div class="relative w-24 h-full shrink-0">
                        <select id="name-picker" onchange="document.getElementById('msg-name').value=this.value; this.value='';" class="w-full h-full bg-white/60 border-2 border-cute-cream rounded-2xl pl-2 pr-6 text-xs font-black text-cute-dark outline-none focus:ring-2 focus:ring-cute-red transition appearance-none m-0">
                            <option value="" disabled selected>â–¼ é¸äºº</option>
                            </select>
                        <div class="pointer-events-none absolute inset-y-0 right-2 flex items-center text-cute-dark/50 text-xs">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </div>
                </div>
                </div>
                    <textarea id="msg-content" rows="3" placeholder="å¯«ä¸‹ä»Šæ—¥æˆ°æ³ã€åƒåœ¾è©±æˆ–ç¶“å…¸èªéŒ„..." class="w-full bg-cute-cream border-0 rounded-2xl px-3 py-3 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-red resize-none transition"></textarea>
                    <button onclick="submitMessage()" class="btn-push w-full bg-cute-red text-white py-3 rounded-2xl font-black shadow-md hover:brightness-110 active:scale-95 transition text-sm">
                        ç™¼å¸ƒç•™è¨€
                    </button>
                </div>
            </div>
            <div id="guestbook-list" class="space-y-3 pb-20"></div>
        </div>

    </div>

    <div id="fund-modal" class="hidden fixed inset-0 z-[70] flex items-end justify-center">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeFundModal()"></div>
        <div class="relative bg-cute-cream w-full max-w-sm rounded-t-[2.5rem] shadow-2xl modal-enter p-6 pb-10 border-t-8 border-cute-yellow flex flex-col max-h-[85vh]">
            <div class="w-16 h-1.5 bg-gray-300 rounded-full mx-auto mb-6 sm:hidden shrink-0"></div>
            
            <h3 class="text-xl font-black text-cute-dark mb-4 flex items-center gap-2 shrink-0">
                <i class="fa-solid fa-file-invoice-dollar text-cute-yellow"></i> å…¬åŸºé‡‘æµæ°´å¸³
            </h3>

            <div class="bg-white p-4 rounded-2xl mb-4 space-y-3 shadow-sm shrink-0">
                <input type="date" id="fund-date" class="w-full bg-cute-cream border-0 rounded-xl px-3 py-2 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-yellow">
                <input type="text" id="fund-item" placeholder="é …ç›® (å¦‚: è²·é£²æ–™)" class="w-full bg-cute-cream border-0 rounded-xl px-3 py-2 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-yellow">
                <div class="flex gap-2">
                    <input type="number" id="fund-amount" placeholder="é‡‘é¡ (+/-)" class="flex-1 bg-cute-cream border-0 rounded-xl px-3 py-2 text-sm font-bold text-cute-dark outline-none focus:ring-2 focus:ring-cute-yellow">
                    <button onclick="addFundRecord()" class="bg-cute-yellow text-cute-dark px-5 py-2 rounded-xl font-black shadow-sm active:scale-95 transition">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto pr-1 space-y-2 mb-4" id="fund-list" style="min-height: 200px;"></div>
            
            <button onclick="closeFundModal()" class="w-full bg-gray-200 text-gray-500 font-bold py-3 rounded-2xl hover:bg-gray-300 transition shrink-0">
                é—œé–‰
            </button>
        </div>
    </div>

    <script>
        // â˜… ä½ çš„æ¸¬è©¦ç‰ˆ URL
        const API_URL = 'https://script.google.com/macros/s/AKfycbyQUvM-ZS2pB4P6ccnfP2C9NnVTuPmHmEqu9nZ9uLv2UpEPF6DAJTKiNucduECm75M/exec'; 
        
        let rawData = [];
        let fundRecords = [];
        let msgRecords = [];
        let configBigTypes = []; 
    
        // æ—¥æ›†ç›¸é—œè®Šæ•¸
        let currentYear = new Date().getFullYear();
        let currentMonth = new Date().getMonth();
        let dailyStats = {}; 
    
        let currentPage = 1;
        const ITEMS_PER_PAGE = 10;
    
        // é‹å‹¢è³‡æ–™åº«
        const fortunes = [
            { t: "å¤§å‰", d: "ä»Šæ—¥é©åˆåšå¤§ç‰Œï¼Œåœ‹å£«ç„¡é›™ä¸æ˜¯å¤¢ï¼", i: "ğŸ€„" },
            { t: "ä¸­å‰", d: "èµ·æ‰‹ä¸é †æ²’é—œä¿‚ï¼Œçµ•å¼µè‡ªæ‘¸åœ¨å¾Œé ­ã€‚", i: "ğŸ€…" },
            { t: "å°å‰", d: "ç©©ç´®ç©©æ‰“ï¼Œå±èƒ¡ä¹Ÿæ˜¯èƒ¡ï¼Œç©å°‘æˆå¤šã€‚", i: "ğŸ²" },
            { t: "å¾®å¦™", d: "å°å¿ƒæ”¾æ§ï¼Œç‰¹åˆ¥æ˜¯ç”Ÿå¼µè¦ç›¯ç·Šä¸€é»ã€‚", i: "âš ï¸" },
            { t: "çˆ†é‹", d: "æ§“ä¸Šé–‹èŠ±ï¼Œæµ·åº•æ’ˆæœˆï¼Œé€šé€šä¾†ï¼", i: "ğŸŒ¸" },
            { t: "æ…è¡Œ", d: "ä»Šæ—¥ä¸å®œè²ªå¤§ï¼Œè¦‹å¥½å°±æ”¶ã€‚", i: "ğŸ›¡ï¸" },
            { t: "å¤©è½", d: "èµ·æ‰‹ç‰Œå‹æ¥µä½³ï¼Œè½ç‰Œé€Ÿåº¦è¶…å¿«ï¼", i: "ğŸ‘‚" },
            { t: "äººå’Œ", d: "ä¸‹å®¶æœƒé¤µç‰Œï¼Œä¸Šå®¶ä¸ç›¯ä½ ï¼Œèˆ’æœã€‚", i: "ğŸ¤" }
        ];
    
        // ä¿®æ”¹å¾Œçš„ loadFortune å‡½å¼ (æ¯æ—¥å›ºå®šé‹å‹¢ç‰ˆ)
        function loadFortune() {
            const todayStr = new Date().toDateString(); // å–å¾—ä»Šå¤©çš„æ—¥æœŸå­—ä¸² (ä¾‹å¦‚ "Sat Jan 10 2026")
            const savedFortune = localStorage.getItem('mahjong_fortune'); // å˜—è©¦è®€å–å­˜æª”
            const savedDate = localStorage.getItem('mahjong_fortune_date'); // å˜—è©¦è®€å–å­˜æª”æ—¥æœŸ
        
            let f;
        
            // åˆ¤æ–·ï¼šå¦‚æœæœ‰å­˜æª”ä¸”æ—¥æœŸæ˜¯ä»Šå¤©ï¼Œå°±ç”¨å­˜æª”çš„
            if (savedFortune && savedDate === todayStr) {
                f = JSON.parse(savedFortune);
            } else {
                // å¦å‰‡ï¼šéš¨æ©ŸæŠ½ä¸€å€‹æ–°çš„
                f = fortunes[Math.floor(Math.random() * fortunes.length)];
                
                // å­˜èµ·ä¾†ï¼Œæ˜å¤©ä¹‹å‰éƒ½ä¸å‡†è®Šï¼
                localStorage.setItem('mahjong_fortune', JSON.stringify(f));
                localStorage.setItem('mahjong_fortune_date', todayStr);
            }
        
            // æ›´æ–°ç•«é¢
            document.getElementById('fortune-text').innerText = f.t;
            document.getElementById('fortune-desc').innerText = f.d;
            document.getElementById('fortune-icon').innerText = f.i;
        }
    
        async function fetchData() {
            const loader = document.getElementById('loading-overlay');
            if (loader) loader.classList.remove('hidden');
            loadFortune();
    
            try {
                document.getElementById('last-update').innerText = "åŒæ­¥ä¸­...";
                const res = await fetch(API_URL);
                const json = await res.json();
                
                if(json.status === 'success') {
                    rawData = json.data;        
                    fundRecords = json.fundData || [];
                    msgRecords = json.msgData || [];
                    configBigTypes = json.bigTypes || []; 
                    
                    processData(rawData);
                    renderGuestbook();
                } else {
                    document.getElementById('last-update').innerText = "è®€å–éŒ¯èª¤";
                }
            } catch (e) {
                console.error(e);
                document.getElementById('last-update').innerText = "é€£ç·šå¤±æ•—";
            } finally {
                setTimeout(() => {
                    if (loader) loader.classList.add('hidden');
                }, 500);
            }
        }
    
        // â˜… æ—¥æœŸæ¨™æº–åŒ–å·¥å…·
        function normalizeDate(rawInput) {
            if (!rawInput) return null;
            let d;
            const str = String(rawInput);
            if (str.includes('T')) {
                d = new Date(str); // ISO æ ¼å¼äº¤çµ¦ Date è½‰æ™‚å€
            } else {
                d = new Date(str.replace(/-/g, '/')); // ç´”æ–‡å­—æ ¼å¼å¼·åˆ¶æ›æ–œç·š
            }
            if (isNaN(d.getTime())) return null;
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, '0');
            const dd = String(d.getDate()).padStart(2, '0');
            return `${y}-${m}-${dd}`;
        }
    
        // â˜… å¼·åˆ¶å–å¾—æœ¬åœ°ä»Šå¤©æ—¥æœŸ (YYYY-MM-DD)
        function getTodayString() {
            const d = new Date();
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, '0');
            const dd = String(d.getDate()).padStart(2, '0');
            return `${y}-${m}-${dd}`;
        }
    
        function processData(data) {
            const INITIAL_FUND_BASE = 0; 
            
            let fundLogsTotal = 0;
            fundRecords.forEach(r => { fundLogsTotal += (parseInt(r.amount) || 0); });
            let totalFund = INITIAL_FUND_BASE + fundLogsTotal;
    
            const players = {}; 
            const achievementMap = {};
            let totalGames = 0;
            const processedGames = new Set();
            dailyStats = {}; 
    
            const targetTypes = (configBigTypes.length > 0) ? configBigTypes : ["å¤©èƒ¡", "å­—ä¸€è‰²", "æ¸…ä¸€è‰²"];
            targetTypes.forEach(t => { achievementMap[t] = { count: 0, users: {} }; });
    
            // â˜… ä¿®æ”¹ï¼šé¡¯ç¤ºæ›´æ–°æ—¥æœŸï¼Œä½†æ—¥æ›†åˆå§‹åŒ–ç‚ºã€Œä»Šå¤©ã€
            if (data.length > 0) {
                const lastItem = data[data.length - 1];
                const stdDate = normalizeDate(lastItem.date); 
                let dateDisplay = stdDate || "æœªçŸ¥";
                document.getElementById('last-update').innerText = `æ›´æ–°ï¼š${dateDisplay}`;
            } else {
                document.getElementById('last-update').innerText = "å°šç„¡ç´€éŒ„";
            }
    
            // â˜… è¨­å®šæ—¥æ›†è®Šæ•¸ç‚ºã€Œä»Šå¤©ã€(ä¸ç®¡è³‡æ–™åº«æœ€å¾Œä¸€ç­†æ˜¯å“ªå¤©)
            const now = new Date();
            currentYear = now.getFullYear();
            currentMonth = now.getMonth();
    
            // 2. çµ±è¨ˆä¸»æˆ°ç¸¾æ•¸æ“š
            data.forEach(row => {
                const name = String(row.name);
                const score = parseInt(row.score) || 0;
                const dateStr = normalizeDate(row.date);
                if (!dateStr) return; 
    
                const gameKey = `${dateStr}-R${row.round}`;
    
                if (!dailyStats[dateStr]) dailyStats[dateStr] = { count: 0, scores: {}, bigHands: [], rounds: {}, loans: [] };
                
                if(!dailyStats[dateStr].scores[name]) dailyStats[dateStr].scores[name] = 0;
                dailyStats[dateStr].scores[name] += score;
    
                if(!dailyStats[dateStr].rounds[row.round]) dailyStats[dateStr].rounds[row.round] = [];
                dailyStats[dateStr].rounds[row.round].push({ name: name, score: score });
    
                if (row.topUp) dailyStats[dateStr].loans.push(name);
                
                if (row.bigNames) {
                    const hands = String(row.bigNames).split(',').filter(h => h);
                    hands.forEach(h => dailyStats[dateStr].bigHands.push({ name: name, type: h }));
                }
                
                if (!processedGames.has(gameKey)) {
                    processedGames.add(gameKey);
                    totalGames++;
                    dailyStats[dateStr].count++;
                }
    
                if (!players[name]) players[name] = { 
                    name: name, total: 0, rounds: 0, wins: 0, 
                    bigCount: 0, penaltyCount: 0, foulCount: 0, bigHands: [], maxContinuance: 0 
                };
    
                players[name].total += score;
                players[name].rounds += 1;
                if (score > 0) players[name].wins += 1;
                players[name].penaltyCount += (parseInt(row.penalty) || 0);
                players[name].foulCount += (parseInt(row.foul) || 0);
    
                const currentContinuance = parseInt(row.continuance) || 0;
                if (currentContinuance > players[name].maxContinuance) players[name].maxContinuance = currentContinuance;
                
                if (row.bigNames) {
                    const hands = String(row.bigNames).split(',').filter(h => h);
                    players[name].bigCount += hands.length;
                    players[name].bigHands.push(...hands);
                    hands.forEach(h => {
                        const type = h.trim();
                        if (achievementMap[type]) {
                            achievementMap[type].count++;
                            if(!achievementMap[type].users[name]) achievementMap[type].users[name] = 0;
                            achievementMap[type].users[name]++;
                        }
                    });
                }
            });
    
            // 3. è™•ç†å…¬åŸºé‡‘
            if (fundRecords && fundRecords.length > 0) {
                fundRecords.forEach(r => {
                    const rDateStr = normalizeDate(r.date);
                    if (rDateStr && dailyStats[rDateStr] && dailyStats[rDateStr].rounds) {
                        const match = String(r.item).match(/ç¬¬\s*(\d+)\s*é†¬/);
                        if (match) {
                            const roundNum = parseInt(match[1]); 
                            if (dailyStats[rDateStr].rounds[roundNum]) {
                                if (dailyStats[rDateStr].rounds[roundNum].fundTotal === undefined) {
                                    dailyStats[rDateStr].rounds[roundNum].fundTotal = 0;
                                }
                                dailyStats[rDateStr].rounds[roundNum].fundTotal += (parseInt(r.amount) || 0);
                            }
                        }
                    }
                });
            }
    
            document.getElementById('stat-total-games').innerText = totalGames;
            document.getElementById('stat-total-fund').innerText = totalFund;
            const sign = fundLogsTotal >= 0 ? '+' : '';
            document.getElementById('fund-base-display').innerText = `å«åº•é‡‘ (å¸³é¢ ${sign}${fundLogsTotal})`;
    
            renderCalendar();
            
            // â˜… å¼·åˆ¶é¸ä¸­ä»Šå¤©ï¼Œä¸ç®¡æœ‰æ²’æœ‰è³‡æ–™
            selectDate(getTodayString());
    
            const sortedPlayers = Object.values(players).sort((a, b) => b.total - a.total);
            renderLeaderboard(sortedPlayers);
            renderKings(players);
            renderAchievements(achievementMap);
            renderPlayerOptions(Object.keys(players));
        }
    
        function renderPlayerOptions(names) {
            const picker = document.getElementById('name-picker');
            if(picker) {
                let html = '<option value="" disabled selected>â–¼ é¸äºº</option>';
                html += names.sort().map(n => `<option value="${n}">${n}</option>`).join('');
                picker.innerHTML = html;
            }
        }
    
        function renderCalendar() {
            const grid = document.getElementById('calendar-body');
            const title = document.getElementById('calendar-title');
            
            grid.innerHTML = '';
            title.innerText = `${currentYear}å¹´ ${currentMonth + 1}æœˆ`;
    
            const firstDay = new Date(currentYear, currentMonth, 1).getDay(); 
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate(); 
    
            for (let i = 0; i < firstDay; i++) {
                grid.innerHTML += `<div class="calendar-day empty"></div>`;
            }
    
            for (let d = 1; d <= daysInMonth; d++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                const hasData = dailyStats[dateKey];
                
                let className = 'calendar-day';
                let content = `<span>${d}</span>`;
                
                if (hasData) {
                    className += ' has-game';
                    content += `<div class="text-[10px] mt-0.5 transform scale-125">ğŸ€„</div>`; 
                    if (dailyStats[dateKey].loans && dailyStats[dateKey].loans.length > 0) {
                            content += `<div class="absolute top-0 right-0.5 text-[8px] animate-bounce" title="ç‘éŠ€å¢è²¸">ğŸ¦</div>`;
                    }
                } else {
                    content += `<div class="h-4"></div>`;
                }
    
                grid.innerHTML += `
                    <div class="${className}" id="day-${dateKey}" onclick="selectDate('${dateKey}')">
                        ${content}
                    </div>
                `;
            }
        }
    
        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
            document.getElementById('day-detail-panel').classList.add('hidden');
            document.getElementById('day-empty-panel').classList.remove('hidden');
        }
    
        function selectDate(dateKey) {
            document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected'));
            const target = document.getElementById(`day-${dateKey}`);
            
            const [y, m, d] = dateKey.split('-').map(Number);
            
            // å¦‚æœé¸ä¸­çš„æ—¥æœŸä¸åœ¨ç•¶å‰æ—¥æ›†æœˆä»½ï¼Œå…ˆåˆ‡æ›éå» (ä¾‹å¦‚ä»Šå¤©æ˜¯ä¸€è™Ÿï¼Œä¸Šå€‹æœˆæœ€å¾Œä¸€å¤©é‚„åœ¨é¡¯ç¤º)
            if(y !== currentYear || (m-1) !== currentMonth) {
                currentYear = y;
                currentMonth = m - 1;
                renderCalendar();
                const newTarget = document.getElementById(`day-${dateKey}`);
                if(newTarget) newTarget.classList.add('selected');
            } else {
                if(target) target.classList.add('selected');
            }
    
            const detailPanel = document.getElementById('day-detail-panel');
            const emptyPanel = document.getElementById('day-empty-panel');
            const stat = dailyStats[dateKey];
    
            if (stat) {
                emptyPanel.classList.add('hidden');
                detailPanel.classList.remove('hidden');
    
                const weekDay = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][new Date(dateKey.replace(/-/g,'/')).getDay()];
                document.getElementById('detail-date').innerText = `${m}/${d} (${weekDay})`;
                document.getElementById('detail-total').innerText = `å…± ${stat.count} å±€`;
    
                let maxScore = -99999;
                let winnerName = "ç„¡";
                for (const [name, s] of Object.entries(stat.scores)) {
                    if (s > maxScore) {
                        maxScore = s;
                        winnerName = name;
                    }
                }
                const color = maxScore > 0 ? 'text-cute-red' : 'text-gray-500';
                document.getElementById('detail-winner').innerHTML = `${winnerName} <span class="${color} ml-1">(${maxScore>0?'+':''}${maxScore})</span>`;
                
                // â˜… æ–°å¢é€™æ®µï¼šåŠ å…¥çµç®—æŒ‰éˆ•
                const winnerDiv = document.getElementById('detail-winner').parentNode;
                // æª¢æŸ¥æ˜¯å¦å·²ç¶“æœ‰æŒ‰éˆ•ï¼Œé¿å…é‡è¤‡æ·»åŠ 
                if (!document.getElementById('btn-open-settle')) {
                    const settleBtn = document.createElement('button');
                    settleBtn.id = 'btn-open-settle';
                    settleBtn.className = "ml-auto bg-cute-green/10 text-cute-green text-xs px-3 py-1.5 rounded-full font-black border border-cute-green/30 hover:bg-cute-green hover:text-white transition flex items-center gap-1";
                    settleBtn.innerHTML = `<i class="fa-solid fa-money-bill-transfer"></i> çµç®—`;
                    // é»æ“Šæ™‚è§¸ç™¼çµç®—å‡½å¼ï¼Œå‚³å…¥ç•¶å¤©æ—¥æœŸ
                    settleBtn.onclick = function() { calculateSettlement(dateKey); };
                    winnerDiv.appendChild(settleBtn);
                } else {
                    // å¦‚æœæŒ‰éˆ•å·²å­˜åœ¨ï¼Œæ›´æ–°å®ƒçš„ onclick äº‹ä»¶ä»¥å°æ‡‰æ–°æ—¥æœŸ
                    document.getElementById('btn-open-settle').onclick = function() { calculateSettlement(dateKey); };
                }
    
                // ç‘éŠ€å¢è²¸é¡¯ç¤º
                const roundsList = document.getElementById('detail-rounds-list');
                let loanArea = document.getElementById('detail-loan-display');
                if(!loanArea) {
                    loanArea = document.createElement('div');
                    loanArea.id = 'detail-loan-display';
                    loanArea.className = 'mt-2 mb-2';
                    roundsList.parentNode.insertBefore(loanArea, roundsList);
                }
                
                if (stat.loans && stat.loans.length > 0) {
                    const uniqueLoans = [...new Set(stat.loans)];
                    loanArea.innerHTML = `
                        <div class="flex items-center gap-2 bg-green-100 p-2 rounded-xl border border-green-200 shadow-sm animate-pulse">
                            <span class="text-xs font-black text-green-700 flex items-center gap-1">
                                <i class="fa-solid fa-sack-dollar"></i> ç‘éŠ€å¢è²¸
                            </span>
                            <span class="text-sm font-black text-green-800">${uniqueLoans.join('ã€')}</span>
                        </div>`;
                } else {
                    loanArea.innerHTML = '';
                }
    
                const handsContainer = document.getElementById('detail-hands');
                handsContainer.innerHTML = '';
                if(stat.bigHands.length > 0) {
                    stat.bigHands.forEach(h => {
                           handsContainer.innerHTML += `<span class="text-[10px] bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full font-bold border border-yellow-200 mr-1 mb-1 inline-block">${h.name}:${h.type}</span>`;
                    });
                } else {
                    handsContainer.innerHTML = `<span class="text-[10px] text-gray-400">æœ¬æ—¥ç„¡ç‰¹æ®Šå¤§ç‰Œ</span>`;
                }
    
                roundsList.innerHTML = '';
                const roundsObj = stat.rounds || {};
                const sortedRounds = Object.keys(roundsObj).sort((a,b) => parseInt(a) - parseInt(b));
    
                if (sortedRounds.length > 0) {
                    roundsList.innerHTML = `<h5 class="font-bold text-xs text-gray-400 mb-2 mt-3 flex items-center gap-1"><i class="fa-solid fa-list-ol"></i> è©³ç´°æˆ°ç¸¾</h5>`;
                    sortedRounds.forEach(rNum => {
                        const players = roundsObj[rNum];
                        players.sort((a,b) => b.score - a.score);
                        
                        const roundFund = players.fundTotal || 0; 
                        let fundBadge = '';
                        
                        if (roundFund !== 0) {
                            const isPlus = roundFund > 0;
                            const badgeColor = isPlus ? 'bg-yellow-100 text-yellow-700 border-yellow-200' : 'bg-gray-100 text-gray-500 border-gray-200';
                            const icon = isPlus ? 'fa-coins' : 'fa-hand-holding-dollar';
                            fundBadge = `<span class="ml-auto text-[10px] ${badgeColor} px-2 py-0.5 rounded-full border shadow-sm flex items-center gap-1 font-bold"><i class="fa-solid ${icon}"></i> ${roundFund > 0 ? '+' : ''}${roundFund}</span>`;
                        }
    
                        let roundHtml = `<div class="bg-white rounded-xl p-3 border border-gray-100 shadow-sm text-xs mb-2 animate-fade-in">
                            <div class="font-black text-gray-300 mb-2 border-b border-gray-50 pb-1 flex items-center">
                                <span class="mr-2">ç¬¬ ${rNum} é†¬</span>
                                ${fundBadge}
                            </div>
                            <div class="grid grid-cols-4 gap-1">`;
                        
                        players.forEach(p => {
                             const pColor = p.score > 0 ? 'text-cute-red' : (p.score < 0 ? 'text-green-600' : 'text-gray-400');
                             const scoreStr = p.score > 0 ? `+${p.score}` : p.score;
                             roundHtml += `<div class="text-center flex flex-col items-center">
                                <div class="font-bold text-gray-600 mb-0.5 whitespace-nowrap overflow-hidden text-ellipsis max-w-full" style="font-size: 0.7rem;">${p.name}</div>
                                <div class="font-black ${pColor} text-sm">${scoreStr}</div>
                             </div>`;
                        });
                        
                        roundHtml += `</div></div>`;
                        roundsList.innerHTML += roundHtml;
                    });
                }
            } else {
                // å¦‚æœä»Šå¤©æ²’æœ‰è³‡æ–™ï¼Œé¡¯ç¤ºç©ºé¢æ¿
                emptyPanel.classList.remove('hidden');
                detailPanel.classList.add('hidden');
            }
        }
    
        async function submitMessage() {
            const date = document.getElementById('msg-date').value;
            const name = document.getElementById('msg-name').value.trim();
            const content = document.getElementById('msg-content').value.trim();
            const btn = document.querySelector('button[onclick="submitMessage()"]');
    
            if (!date || !name || !content) { alert('è«‹å¡«å¯«å®Œæ•´'); return; }
    
            const originalText = btn.innerHTML;
            btn.disabled = true; btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i>`;
    
            try {
                await fetch(API_URL, {
                    method: 'POST', mode: 'no-cors',
                    body: JSON.stringify({ type: 'message', date: date, name: name, message: content })
                });
                document.getElementById('msg-content').value = '';
                // ç™¼å¸ƒå®Œè¨Šæ¯ä¹Ÿé‡ç½®å›ä»Šå¤©
                document.getElementById('msg-date').value = getTodayString();
                await fetchData();
            } catch (e) { alert('ç™¼å¸ƒå¤±æ•—'); } finally {
                btn.disabled = false; btn.innerHTML = originalText;
            }
        }
    
        function switchTab(tabName) { 
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.className = 'tab-btn flex-1 py-2.5 rounded-xl text-sm font-black text-white hover:bg-white/10 transition whitespace-nowrap px-1 drop-shadow-md';
            });
            const btnId = `btn-${tabName}`;
            const targetBtn = document.getElementById(btnId);
            if(targetBtn) {
                targetBtn.className = 'tab-btn active flex-1 py-2.5 rounded-xl text-sm font-black transition whitespace-nowrap px-1 drop-shadow-sm';
            }
            ['overview', 'ranking', 'achievement', 'guestbook'].forEach(t => {
                const el = document.getElementById(`tab-${t}`);
                if(el) el.classList.add('hidden');
            });
            const target = document.getElementById(`tab-${tabName}`);
            if(target) target.classList.remove('hidden');
        }
    
        function renderGuestbook() { 
            const list = document.getElementById('guestbook-list');
            if(msgRecords.length === 0) { list.innerHTML = `<div class="text-center text-white/50 py-8 text-xs italic">é‚„æ²’æœ‰äººç•™è¨€...</div>`; return; }
            const sortedMsgs = [...msgRecords].reverse();
            const totalPages = Math.ceil(sortedMsgs.length / ITEMS_PER_PAGE);
            if (currentPage < 1) currentPage = 1;
            if (currentPage > totalPages) currentPage = totalPages;
            const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const currentData = sortedMsgs.slice(startIndex, endIndex);
            
            let itemsHtml = currentData.map((msg, index) => {
                const dStr = normalizeDate(msg.date);
                let dateShow = dStr ? dStr.replace(/-/g, '/') : msg.date;
                const safeName = String(msg.name); 
                const firstChar = safeName.substring(0, 1);
                
                return `
                <div class="flex gap-3 bg-white p-4 rounded-2xl border-4 border-white shadow-[0_4px_0_rgba(0,0,0,0.05)] animate-fade-in transform hover:-translate-y-1 transition" style="animation-delay: ${index * 0.05}s">
                    <div class="flex-shrink-0 w-10 h-10 bg-cute-yellow text-cute-dark rounded-full flex items-center justify-center font-black shadow-inner border-2 border-white">${firstChar}</div>
                    <div class="flex-1">
                        <div class="flex justify-between items-start mb-1">
                            <div class="font-black text-cute-dark text-sm">${safeName}</div>
                            <div class="text-[10px] text-gray-400 font-bold bg-gray-100 px-2 py-0.5 rounded-full">${dateShow}</div>
                        </div>
                        <p class="text-gray-600 text-xs font-bold leading-relaxed whitespace-pre-wrap">${msg.message}</p>
                    </div>
                </div>`;
            }).join('');
            
            const paginationHtml = `<div class="flex justify-center items-center gap-4 mt-6 pt-2 animate-fade-in" style="animation-delay: 0.5s"><button onclick="changePage(-1)" ${currentPage === 1 ? 'disabled' : ''} class="w-10 h-10 rounded-full bg-white shadow-sm border-2 border-white text-cute-red hover:bg-cute-cream transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center font-bold"><i class="fa-solid fa-chevron-left"></i></button><span class="text-xs font-black text-white bg-white/20 px-3 py-1 rounded-full">ç¬¬ ${currentPage} / ${totalPages} é </span><button onclick="changePage(1)" ${currentPage === totalPages ? 'disabled' : ''} class="w-10 h-10 rounded-full bg-white shadow-sm border-2 border-white text-cute-red hover:bg-cute-cream transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center font-bold"><i class="fa-solid fa-chevron-right"></i></button></div>`;
            
            list.innerHTML = itemsHtml + paginationHtml;
        }
    
        function changePage(delta) { currentPage += delta; renderGuestbook(); document.getElementById('tab-guestbook').scrollIntoView({ behavior: 'smooth', block: 'start' }); }
    
        function renderLeaderboard(players) { 
            const container = document.getElementById('rank-list');
            let htmlContent = '';
            players.forEach((p, index) => {
                let rankStyle = "bg-white border-gray-100";
                let badgeBg = "bg-gray-100 text-gray-500 border-gray-200";
                let rankLabel = `${index + 1}`;
                
                if (index === 0) { rankLabel = `ğŸ¥‡`; rankStyle = "bg-yellow-50 border-yellow-200"; badgeBg = "bg-yellow-100 text-yellow-700 border-yellow-200"; }
                else if (index === 1) { rankLabel = `ğŸ¥ˆ`; badgeBg = "bg-gray-200 text-gray-600 border-gray-300"; }
                else if (index === 2) { rankLabel = `ğŸ¥‰`; badgeBg = "bg-orange-100 text-orange-700 border-orange-200"; }
                
                const scoreColor = p.total >= 0 ? 'text-cute-red' : 'text-green-600';
                
                htmlContent += `
                    <div class="flex items-center justify-between p-3 rounded-2xl border-2 ${rankStyle} mb-2 shadow-sm relative animate-fade-in transform hover:scale-[1.02] transition" style="animation-delay: ${index * 0.05}s">
                        <div class="flex items-center gap-3">
                            <div class="text-lg font-black ${badgeBg} w-10 h-10 flex items-center justify-center rounded-lg border shadow-sm">${rankLabel}</div>
                            <div>
                                <div class="font-black text-cute-dark">${p.name}</div>
                                <div class="text-[10px] text-gray-400 font-bold bg-white/50 px-1.5 rounded inline-block">å…± ${p.rounds} å±€</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-black text-lg ${scoreColor} font-mono">${p.total > 0 ? '+' : ''}${p.total}</div>
                        </div>
                    </div>`;
            });
            container.innerHTML = htmlContent;
        }
    
        function renderKings(playersObj) { 
            const list = Object.values(playersObj);
            const findKings = (key) => { const maxVal = Math.max(...list.map(p => p[key])); if (maxVal === 0) return null; const winners = list.filter(p => p[key] === maxVal); return { names: winners.map(p => p.name).join(' & '), count: maxVal }; };
            const bigKing = findKings('bigCount');
            const foulKing = findKings('foulCount');
            const penaltyKing = findKings('penaltyCount');
            const continuanceKing = findKings('maxContinuance'); 
            const updateKingUI = (id, data, unit = "æ¬¡") => { if(data) { document.getElementById(id).innerText = data.names; if(data.names.length > 10) document.getElementById(id).classList.replace('text-sm', 'text-xs'); document.getElementById(id + '-val').innerText = `${data.count}${unit}`; } else { document.getElementById(id).innerText = "å¾ç¼º"; document.getElementById(id + '-val').innerText = `0${unit}`; } };
            updateKingUI('king-big', bigKing);
            updateKingUI('king-foul', foulKing);
            updateKingUI('king-penalty', penaltyKing);
            updateKingUI('king-continuance', continuanceKing, "é€£èŠ"); 
        }
    
        function renderAchievements(map) { 
            const container = document.getElementById('achievement-list');
            let htmlContent = '';
            let idx = 0;
            for (const [type, data] of Object.entries(map)) {
                let usersHtml = data.count > 0 ? Object.entries(data.users).sort((a, b) => b[1] - a[1]).map(([name, count]) => `<span class="inline-block bg-white px-2 py-1 rounded-lg text-xs text-cute-dark font-bold border border-gray-100 shadow-sm mr-1 mb-1">${name} <span class="text-cute-red ml-1">x${count}</span></span>`).join('') : `<span class="text-xs text-gray-300 italic font-bold">å°šç„¡äººé”æˆ</span>`;
                const cardStyle = data.count > 0 ? 'bg-yellow-50 border-cute-yellow opacity-100' : 'bg-gray-50 border-gray-100 opacity-60 grayscale';
                const iconColor = data.count > 0 ? 'text-cute-red' : 'text-gray-300';
                
                htmlContent += `<div class="rounded-2xl border-4 ${cardStyle} p-4 flex flex-col gap-2 transition hover:grayscale-0 shadow-sm animate-fade-in hover:scale-[1.02]" style="animation-delay: ${idx * 0.05}s"><div class="flex justify-between items-center"><span class="font-black text-cute-dark flex items-center gap-2 text-lg"><i class="fa-solid fa-dragon ${iconColor}"></i> ${type}</span><span class="text-xs font-black text-gray-400 bg-white px-3 py-1 rounded-full border border-gray-100 shadow-sm">å…± ${data.count} æ¬¡</span></div><div class="mt-1 flex flex-wrap">${usersHtml}</div></div>`;
                idx++;
            }
            container.innerHTML = htmlContent;
        }
    
        function openFundModal() {
            document.getElementById('fund-modal').classList.remove('hidden');
            document.getElementById('fund-date').value = getTodayString(); // ä½¿ç”¨å¼·åˆ¶æœ¬åœ°æ™‚é–“
            renderFundList(); 
        }
        function closeFundModal() { document.getElementById('fund-modal').classList.add('hidden'); }
        
        async function addFundRecord() {
            const date = document.getElementById('fund-date').value;
            const item = document.getElementById('fund-item').value.trim();
            const amount = parseInt(document.getElementById('fund-amount').value);
            const btn = document.querySelector('button[onclick="addFundRecord()"]');
            if (!date || !item || isNaN(amount)) { alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™'); return; }
            const originalText = btn.innerHTML;
            btn.disabled = true; btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i>`;
            try { await fetch(API_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ type: 'fund', date: date, item: item, amount: amount }) }); document.getElementById('fund-item').value = ''; document.getElementById('fund-amount').value = ''; await fetchData(); } catch (e) { alert('ä¸Šå‚³å¤±æ•—'); } finally { btn.disabled = false; btn.innerHTML = originalText; }
        }
    
        function renderFundList() {
            const list = document.getElementById('fund-list');
            if(fundRecords.length === 0) { list.innerHTML = `<div class="text-center text-gray-400 py-8 text-xs font-bold">ç›®å‰ç„¡é›²ç«¯ç´€éŒ„</div>`; return; }
            const sortedRecords = [...fundRecords].sort((a, b) => new Date(b.date) - new Date(a.date));
            const groups = {};
            sortedRecords.forEach(r => {
                const safeDate = normalizeDate(r.date);
                const d = safeDate ? new Date(safeDate.replace(/-/g, '/')) : new Date(); 
                let monthKey = "æœªçŸ¥";
                if(!isNaN(d.getTime())) { 
                    monthKey = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`; 
                }
                if(!groups[monthKey]) { groups[monthKey] = { total: 0, items: [] }; }
                groups[monthKey].items.push(r); 
                groups[monthKey].total += (parseInt(r.amount) || 0);
            });
    
            list.innerHTML = Object.keys(groups).map((monthKey, index) => {
                const group = groups[monthKey]; 
                const isCurrentMonth = index === 0;
                const monthTotalColor = group.total >= 0 ? 'text-cute-red' : 'text-green-600';
                const sign = group.total > 0 ? '+' : '';
                
                let lastDateStr = '';
                let useAltBg = false;
    
                const itemsHtml = group.items.map((r, idx) => {
                    let day = "??"; 
                    const safeDate = normalizeDate(r.date);
                    const d = safeDate ? new Date(safeDate.replace(/-/g, '/')) : new Date();
                    const currentDateStr = !isNaN(d.getTime()) ? d.toDateString() : (r.date + idx);
    
                    if(!isNaN(d.getTime())) day = String(d.getDate()).padStart(2, '0');
                    
                    if (currentDateStr !== lastDateStr) { useAltBg = !useAltBg; lastDateStr = currentDateStr; }
                    const bgClass = useAltBg ? 'bg-red-50/50' : 'bg-white';
                    
                    return `
                    <div class="flex justify-between items-center ${bgClass} p-3 border-b border-gray-100 last:border-0 hover:brightness-95 transition animate-fade-in" style="animation-delay: ${idx * 0.05}s">
                        <div class="flex items-center gap-3">
                            <div class="text-xs font-black text-cute-red bg-white w-8 h-8 flex items-center justify-center rounded-lg shadow-sm border border-red-100">${day}æ—¥</div>
                            <div class="font-bold text-gray-700 text-sm">${r.item}</div>
                        </div>
                        <div class="font-black ${r.amount >= 0 ? 'text-cute-red' : 'text-green-600'}">${r.amount > 0 ? '+' : ''}${r.amount}</div>
                    </div>`;
                }).join('');
    
                return `
                <details class="group mb-3 border-2 border-gray-100 rounded-2xl bg-white overflow-hidden shadow-sm animate-fade-in" ${isCurrentMonth ? 'open' : ''} style="animation-delay: ${index * 0.1}s">
                    <summary class="flex justify-between items-center p-4 cursor-pointer select-none bg-gray-50 hover:bg-gray-100 transition sticky top-0 z-10">
                        <div class="flex items-center gap-2 font-black text-gray-600"><i class="fa-regular fa-calendar-days text-cute-yellow"></i><span>${monthKey}</span></div>
                        <div class="font-black text-sm ${monthTotalColor}">å°è¨ˆ ${sign}${group.total}</div>
                    </summary>
                    <div class="border-t border-gray-100">${itemsHtml}</div>
                </details>`;
            }).join('');
        }
        
        // åˆå§‹åŒ–è¨­å®šï¼šå¼·åˆ¶è¨­ç‚ºä»Šå¤©
        const todayStr = getTodayString();
        const msgInput = document.getElementById('msg-date');
        const fundInput = document.getElementById('fund-date');
        if(msgInput) msgInput.value = todayStr;
        if(fundInput) fundInput.value = todayStr;
    
        fetchData();
        // === æ™ºæ…§çµç®—åŠŸèƒ½ V3 (æŒ‡å®šä»˜æ¬¾äººç‰ˆ) ===
        
        // ç”¨ä¾†æš«å­˜ç•¶æ¬¡è¨ˆç®—çš„æ•¸æ“šï¼Œä»¥ä¾¿åœ¨é¸äººå¾Œç¹¼çºŒè¨ˆç®—
        let currentSettleSession = null;
        
        function calculateSettlement(dateKey) {
            const stat = dailyStats[dateKey];
            if (!stat || !stat.scores) return;
        
            // 1. å–å¾—è©²æ—¥æ‰€æœ‰ç©å®¶è³‡æ–™
            let players = [];
            for (const [name, score] of Object.entries(stat.scores)) {
                // 0åˆ†ä¹Ÿè¦åˆ—å…¥ï¼Œå› ç‚ºä»–å¯èƒ½è² è²¬ä»˜éŒ¢
                players.push({ name, score: parseInt(score) });
            }
        
            const listEl = document.getElementById('settle-list');
            listEl.innerHTML = '';
            
            // 2. è¨ˆç®—å·®é¡ (å…¬åŸºé‡‘ç¸½é¡)
            const sum = players.reduce((acc, p) => acc + p.score, 0);
            const gap = Math.abs(sum);
        
            // å„²å­˜æš«å­˜æª”ï¼Œä¾›ä¸‹ä¸€æ­¥ä½¿ç”¨
            currentSettleSession = {
                players: JSON.parse(JSON.stringify(players)), // æ·±æ‹·è²é¿å…æ±™æŸ“åŸå§‹è³‡æ–™
                gap: gap
            };
        
            // 3. åˆ¤æ–·æµç¨‹
            if (sum === 0) {
                // A. å¦‚æœå¸³æœ¬èº«å°±æ˜¯å¹³çš„ (æ²’å·®é¡)ï¼Œç›´æ¥ç®—
                renderFinalSettlement(currentSettleSession.players, 0, null);
            } else {
                // B. å¦‚æœæœ‰å·®é¡ (æœ‰å…¬åŸºé‡‘)ï¼Œé¡¯ç¤ºã€Œé¸äººç•«é¢ã€
                renderPayerSelection(gap);
            }
        
            // é¡¯ç¤ºè¦–çª—
            document.getElementById('settle-modal').classList.remove('hidden');
        }
        
        // æ¸²æŸ“ã€Œé¸æ“‡ä»˜æ¬¾äººã€çš„ä»‹é¢
        function renderPayerSelection(gap) {
            const listEl = document.getElementById('settle-list');
            
            // æ¨™é¡Œæç¤º
            let html = `
                <div class="text-center mb-4 animate-fade-in">
                    <div class="text-xs font-bold text-gray-400 mb-1">æœ¬å ´æ¬¡å…¬åŸºé‡‘ç¸½é¡</div>
                    <div class="text-3xl font-black text-yellow-500 mb-4">$${gap}</div>
                    <div class="text-sm font-bold text-cute-dark bg-yellow-50 py-2 rounded-xl border border-yellow-200">
                        ğŸ‘‡ è«‹å•æ˜¯èª°ä»˜ç¾çš„ï¼Ÿ
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3 animate-fade-in" style="animation-delay: 0.1s">
            `;
        
            // åˆ—å‡ºæ‰€æœ‰ç©å®¶æŒ‰éˆ•
            // ä¾åˆ†æ•¸æ’åºï¼Œé€šå¸¸è´å®¶(åˆ†é«˜)æˆ–è¼¸å®¶(åˆ†ä½)æ¯”è¼ƒå¸¸ä»˜éŒ¢ï¼Œæ–¹ä¾¿æ‰¾
            currentSettleSession.players.sort((a,b) => b.score - a.score);
            
            currentSettleSession.players.forEach(p => {
                html += `
                    <button onclick="selectPayer('${p.name}')" class="flex items-center justify-between bg-white border-2 border-gray-100 hover:border-cute-red hover:bg-red-50 p-3 rounded-2xl transition group">
                        <span class="font-black text-gray-600 group-hover:text-cute-red">${p.name}</span>
                        <span class="text-xs font-bold text-gray-300 bg-gray-100 px-2 py-0.5 rounded-full">${p.score}</span>
                    </button>
                `;
            });
        
            html += `</div>`;
            
            // åº•éƒ¨è£œå……èªªæ˜
            html += `<div class="mt-4 text-center text-[10px] text-gray-300 font-bold">é»é¸å¾Œç³»çµ±å°‡è‡ªå‹•è£œæ­£å·®é¡ä¸¦è¨ˆç®—è½‰å¸³è·¯å¾‘</div>`;
        
            listEl.innerHTML = html;
        }
        
        // ä½¿ç”¨è€…é¸äº†æŸäººä»˜æ¬¾å¾Œ
        function selectPayer(name) {
            if (!currentSettleSession) return;
            
            // 1. æ‰¾å‡ºè©²ç©å®¶ï¼ŒæŠŠå…¬åŸºé‡‘(gap)åŠ å›ä»–çš„åˆ†æ•¸
            // åŸç†ï¼šä»–ä»˜äº†ç¾é‡‘ï¼Œæ‰€ä»¥è¦æŠŠé€™ç­†ã€Œè² å‚µã€å¾å¸³ä¸Šæ¶ˆé™¤ï¼Œè®Šæˆåˆ¥äººæ¬ ä»–
            const target = currentSettleSession.players.find(p => p.name === name);
            if (target) {
                target.score += currentSettleSession.gap;
            }
        
            // 2. é€²å…¥æœ€çµ‚çµç®—
            renderFinalSettlement(currentSettleSession.players, currentSettleSession.gap, name);
        }
        
        // æ¸²æŸ“æœ€çµ‚è½‰å¸³åˆ—è¡¨ (Greedyæ¼”ç®—æ³•)
        function renderFinalSettlement(players, gap, payerName) {
            const listEl = document.getElementById('settle-list');
            
            // åˆ†çµ„ï¼šæ¬ éŒ¢çš„ (Debtors) vs æ”¶éŒ¢çš„ (Creditors)
            let debtors = players.filter(p => p.score < 0).sort((a, b) => a.score - b.score);
            let creditors = players.filter(p => p.score > 0).sort((a, b) => b.score - a.score);
        
            let transactions = [];
            let i = 0, j = 0;
        
            while (i < debtors.length && j < creditors.length) {
                let debtor = debtors[i];
                let creditor = creditors[j];
                let amount = Math.min(Math.abs(debtor.score), creditor.score);
        
                if (amount > 0) {
                    transactions.push({ from: debtor.name, to: creditor.name, amount: amount });
                }
        
                debtor.score += amount;
                creditor.score -= amount;
        
                if (Math.abs(debtor.score) < 0.1) i++;
                if (creditor.score < 0.1) j++;
            }
        
            // ç”¢ç”Ÿ HTML
            let html = '';
        
            // å¦‚æœæœ‰æŒ‡å®šä»˜æ¬¾äººï¼Œé¡¯ç¤ºä¸€å€‹æ¨™è¨˜
            if (payerName) {
                html += `
                    <div class="flex items-center gap-2 bg-yellow-50 p-3 rounded-xl border border-yellow-200 mb-4 animate-fade-in">
                        <div class="bg-yellow-400 text-white w-8 h-8 rounded-full flex items-center justify-center shrink-0 shadow-sm"><i class="fa-solid fa-hand-holding-dollar"></i></div>
                        <div class="flex-1">
                            <div class="text-[10px] font-bold text-yellow-600 uppercase">å·²è¨˜éŒ„ä»£å¢Šæ¬¾</div>
                            <div class="text-sm font-black text-cute-dark">å…¬åŸºé‡‘ $${gap} ç”± <span class="text-yellow-600 underline decoration-2 underline-offset-2">${payerName}</span> æ”¯ä»˜</div>
                        </div>
                        <button onclick="calculateSettlement('${currentSettleDataKey}')" class="text-xs text-gray-400 underline p-1">é‡é¸</button>
                    </div>
                `;
            }
        
            if (transactions.length === 0) {
                html += `<div class="text-center text-gray-400 font-bold py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">å¸³ç›®å·²å¹³ï¼Œç„¡éœ€äº’è½‰ ğŸ‰</div>`;
            } else {
                transactions.forEach((t, idx) => {
                    html += `
                    <div class="flex items-center justify-between bg-white p-3 rounded-2xl border-2 border-gray-100 mb-2 shadow-sm animate-fade-in" style="animation-delay: ${idx * 0.1}s">
                        <div class="flex items-center gap-2 flex-1">
                            <div class="font-black text-gray-600 w-16 text-right truncate text-sm">${t.from}</div>
                            <div class="text-gray-300 text-xs"><i class="fa-solid fa-arrow-right"></i></div>
                            <div class="font-black text-cute-dark w-16 truncate text-sm">${t.to}</div>
                        </div>
                        <div class="font-black text-lg text-cute-green flex items-center gap-1">
                            <span class="text-xs text-gray-400">$</span>${t.amount}
                        </div>
                    </div>`;
                });
            }
        
            listEl.innerHTML = html;
        }
        
        // è£œå……ï¼šç‚ºäº†è®“ã€Œé‡é¸ã€æŒ‰éˆ•èƒ½é‹ä½œï¼Œæˆ‘å€‘éœ€è¦æŠŠ dateKey å­˜æˆå…¨åŸŸè®Šæ•¸
        let currentSettleDataKey = '';
        // ä¿®æ”¹ calculateSettlement é–‹é ­ï¼ŒæŠŠ dateKey å­˜èµ·ä¾†
        const originalCalc = calculateSettlement;
        calculateSettlement = function(dateKey) {
            currentSettleDataKey = dateKey;
            originalCalc(dateKey);
        };
        
        // é—œé–‰è¦–çª—åŠŸèƒ½ä¿æŒä¸è®Š
        function closeSettleModal() {
            document.getElementById('settle-modal').classList.add('hidden');
        }
    </script>
    <div id="settle-modal" class="hidden fixed inset-0 z-[80] flex items-center justify-center">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="closeSettleModal()"></div>
    
    <div class="relative bg-white w-full max-w-sm rounded-[2rem] shadow-2xl modal-enter p-6 border-4 border-white mx-4">
        <div class="flex justify-between items-center mb-4 border-b border-gray-100 pb-3">
            <h3 class="text-xl font-black text-cute-dark flex items-center gap-2">
                <i class="fa-solid fa-calculator text-cute-green"></i> å¸³å‹™çµç®—æ©Ÿ
            </h3>
            <button onclick="closeSettleModal()" class="w-8 h-8 rounded-full bg-gray-100 text-gray-400 hover:bg-gray-200 flex items-center justify-center transition">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>

        <div id="settle-list" class="space-y-3 mb-6 min-h-[150px]">
            </div>

        <button onclick="copySettlement()" class="w-full bg-cute-dark text-white py-3 rounded-2xl font-black shadow-lg hover:brightness-110 active:scale-95 transition flex items-center justify-center gap-2">
            <i class="fa-regular fa-copy"></i> è¤‡è£½è½‰å¸³æ¸…å–®
        </button>
        <p class="text-center text-[10px] text-gray-400 mt-2 font-bold">â€» è«‹ç¢ºèªç¸½åˆ†å¹³è¡¡ï¼Œç³»çµ±å·²è‡ªå‹•è¨ˆç®—æœ€ç°¡è·¯å¾‘</p>
    </div>
    </div>
</body>
</html>